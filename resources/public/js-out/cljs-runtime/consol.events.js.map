{"version":3,"sources":["consol/events.cljs"],"mappings":";AAKA,GAAA,QAAAA,mCAAAC,0CAAAC;AAAA;AAAA,AAAA,AAAmBC,iCAAW,6CAAA,7CAACC;;AAE/B;;;+BAAA,/BAAOC,sEAEAC;AAFP,AAGE,IAAOC,KAAGD;;AAAV,AACE,GACE,OAAA,NAAMC;AADR;;AAAA,oBAEE,uBAAA,vBAACC,oBAAUD;AAAiBA;;AAF9B,AAGQ,cAAO,AAAiBA;;;;;;;;;AAEpC,yBAAA,zBAAOE,0DAAcC;AAArB,AACE,IAAMH,KAAG,AAACF,6BAAe,AAAUK;IAC7BC,SAAO,AAACC,eAAK,uBAAA,vBAACJ,oBAAUD;AAD9B,AAEE,oBAAMI;AAAN,AACE,AAAiBD;;AACjB,qCAAA,2CAAA,gEAAA,qDAAA,9LAACG,kIAA2BF,yDAAWJ,yDAAUG;;AAFnD;;;AAIJ,6BAAA,7BAAMI;AAAN,AAEE,oBAAA,AAAAC,gBAAWZ;AAAX;;AAAA,AACE,0BAAA,1BAAmBa,kCAAoBP;;AACvC,4DAAA,rDAACQ,sBAAOd;;;AAEZ,6BAAA,7BAAMe;AAAN,AAEE,oBAAA,AAAAH,gBAAOZ;AAAP,AACE,6BAAA,7BAAsBa,qCAAoBP;;AAC1C,4DAAA,rDAACQ,sBAAOd;;AAFV","names":["js/consol","js/consol.events","js/consol.events.installed?","consol.events/installed?","cljs.core.atom","consol.events/find-action-el","target","el","consol.util/dataset","consol.events/on-click","e","action","consol.util/kw","consol.actions/dispatch!","consol.events/attach!","cljs.core/deref","js/document","cljs.core/reset!","consol.events/detach!"],"sourcesContent":[";; src-cljs/slab/events.cljs\n(ns consol.events\n  (:require [consol.util :as u]\n            [consol.actions :as actions]))\n\n(defonce ^:private installed? (atom false))\n\n(defn- find-action-el\n  \"Walk up from target to find an element with data-slab-action.\"\n  [^js target]\n  (loop [el target]\n    (cond\n      (nil? el) nil\n      (u/dataset el \"slabAction\") el\n      :else (recur (.-parentElement el)))))\n\n(defn- on-click [^js e]\n  (let [el (find-action-el (.-target e))\n        action (u/kw (u/dataset el \"slabAction\"))]\n    (when action\n      (.preventDefault e)\n      (actions/dispatch! {:action action :el el :event e}))))\n\n(defn attach!\n  []\n  (when-not @installed?\n    (.addEventListener js/document \"click\" on-click)\n    (reset! installed? true)))\n\n(defn detach!\n  []\n  (when @installed?\n    (.removeEventListener js/document \"click\" on-click)\n    (reset! installed? false)))\n"]}