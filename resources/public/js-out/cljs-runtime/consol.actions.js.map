{"version":3,"sources":["consol/actions.cljs"],"mappings":";AAKA,iCAAA,yCAAAA,1EAAMI;AAAN,AAAA,IAAAH,YAAAD;IAAAC,gBAAA,AAAAC,4BAAAD;SAAA,AAAAE,4CAAAF,cAAA,/DAA0BI;AAA1B,AACE,IAAMC,OAAK,AAACC,yBAAkBF;IACxBG,OAAK,AAACC,oCAAwBH,KAAKD;AADzC,AAEE,oBAAMG;AAAN,AACE,AAACE,8BAAkBF;;OACf,AAACG,2BAAeL,3BAChB,sCAAO,WAAKM,xDAKZ;AALO,AACE,IAAAC,UAAM,AAAA,mFAAOD;IAAbC,cAAA,EAAA,CAAAA,mBAAAC,oBAAA,AAAAD,YAAA;AAAA,AAAA,QAAAA;KAAA;AACQ,OAACE,2BAAeP,KAAKI;;;KAD7B;AAEQ,OAACI,2BAAeR,KAAKI;;;;AAC3B,uCAAA,2CAAA,3EAACG,2BAAeP,sGAAY,AAACS,wGAAOL;;;UACvC,WAAKM;AAAL,AACE,OAACC,4BAAgBX,KAAKU;;;AATtC;;;AAWJ,yBAAA,2CAAA,pEAAeE,kIACDhB;AAEd,gCAAA,wCAAAiB,xEAAME;AAAN,AAAA,IAAAD,YAAAD;IAAAC,gBAAA,AAAApB,4BAAAoB;UAAAA,NAAqCG;aAArC,AAAAtB,4CAAAmB,cAAA,nEAAyBE;AAAzB,AACE,IAAAE,qBAAW,AAACvB,4CAAIiB,uBAAQI;AAAxB,AAAA,oBAAAE;AAAA,QAAAA,JAASC;AAAT,AACE,QAACA,kCAAAA,uCAAAA,PAAEF,mBAAAA;;AACH,oBAAA,bAACG,+BAAkC,AAACC,eAAKL,QAAQC","names":["p__8601","map__8602","cljs.core/--destructure-map","cljs.core.get","consol.actions/run-token!","el","info","consol.tokens/token-info","slot","consol.dom/ensure-output-slot!","consol.dom/show-loading!","consol.net/run-token!","resp","G__8603","cljs.core/Keyword","consol.dom/show-text!","consol.dom/show-rich!","cljs.core.pr_str","e","consol.dom/show-error!","consol.actions/actions","p__8604","map__8605","consol.actions/dispatch!","action","ctx","temp__5821__auto__","f","js/console.warn","cljs.core/name"],"sourcesContent":["(ns consol.actions\n  (:require [consol.tokens :as tokens]\n            [consol.dom :as dom]\n            [consol.net :as net]))\n\n(defn run-token! [{:keys [el]}]\n  (let [info (tokens/token-info el)\n        slot (dom/ensure-output-slot! info el)]\n    (when slot\n      (dom/show-loading! slot)\n      (-> (net/run-token! info)\n          (.then (fn [resp]\n                   (case (:type resp)\n                     :text (dom/show-text! slot resp)\n                     :rich (dom/show-rich! slot resp)\n                     (dom/show-text! slot {:body (pr-str resp)}))))\n          (.catch (fn [e]\n                    (dom/show-error! slot e)))))))\n\n(def ^:private actions\n  {:run-token run-token!})\n\n(defn dispatch! [{:keys [action] :as ctx}]\n  (if-let [f (get actions action)]\n    (f ctx)\n    (js/console.warn \"Unknown action:\" (name action) ctx)))\n"]}